<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>node chunk-uploader sample</title>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

</head>


  <body>
          <script src="js/app.js"></script>
          <script>


                var _file_ui_template
                       = '<div id="$(ID)"><div class="info progressview" ><span>&nbsp;</span></div>'
                _file_ui_template += '<div class="btn-group btn-group-justified hidden"> '
                _file_ui_template += '  <a class="btn btn-default "><span class="glyphicon glyphicon-play"></span> start</a>';
                _file_ui_template += '  <a class="btn btn-default"><span class="glyphicon glyphicon-remove"></span> quit</a>';
                _file_ui_template += '  <a class="btn btn-default"><span class="glyphicon glyphicon-wrench"></span> options</a>';
                _file_ui_template += '</div>';

                _file_ui_template += '<div  class="progress hidden">';
                _file_ui_template += '  <div class="progress-bar" style="width: 0%;"><span></span></div>';
                _file_ui_template += '</div>';

            _file_ui_template += '</div>';

              $upm.setOptions({"url" : "http://localhost:3000/upload"});


              $upm.on('new', (id) => {
                 
                    var file_list = $('#file_list');
                    //var uiid = "div_" + new Date().getTime().toString();
                    
                    file_list.append(_file_ui_template.replace('$(ID)', id)); 


                    var div = jQuery("#" + id);

                    var info = div.children().first();
                      info.removeClass('progressview');

                    var txt = info.children().first();

                    var buttons = div.find(':nth-child(2)').first();
                        buttons.removeClass('hidden');

                    var progress = div.children(':nth-child(3)');
                        progress.removeClass('hidden');

                    var $pause = buttons.find(':first-child').first();//.find(':first-child');
                    var $quit  = buttons.find(':nth-child(2)').first();//.find(':first-child');
                    var $opt   = buttons.find(':nth-child(3)').first();//.find(':first-child');

                    var myself  = $upm.uploader[id];
                    var mypause = $pause;

                    $pause.click(function () { if (myself.paused()) { myself.resume(); mypause.html('<span class="glyphicon glyphicon-pause"></span> pause'); } else { myself.pause(); mypause.html('<span class="glyphicon glyphicon-play"></span> resume'); } });

                $opt.click(function () {
                    //txt.text("options clicked");
                    alert('no options available');
                }
                );

                $quit.click(function () {
                    txt.text("Quitted");
                    myself.pause();

                        $pause.hide();
                }
                );

                myself.on('completed', function() { alert("done " + myself.name()); });

                txt.text(myself.name());

                myself.on('progress', function (num) {

                    var d = new Number(num);
                    var x = new String(d.toFixed(0)) + '%';
                    var s = new String(d.toFixed(2)) + '%';

                    progress.find(":first-child").css('width', x);
                    progress.find(":first-child :first-child").text(s);

                });




              }); 

          </script>
  </body>


  <div>
        <input id="file_input" multiple type="file" onchange='$upm.selectFiles(this)'>
    
    </div>


    <div id="file_list">
    </div>



<script src="https://code.jquery.com/jquery-1.12.4.min.js"
            integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="
            crossorigin="anonymous"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>



</html>

